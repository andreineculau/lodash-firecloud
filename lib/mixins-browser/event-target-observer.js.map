{"version":3,"sources":["../../src/mixins-browser/event-target-observer.ts"],"names":[],"mappings":"gHAAA,wD;;AAEO,MAAM,mBAAN,CAA0B;;;;;AAK/B,EAAA,WAAW,CAAC,EAAD,EAAK,8BAJV,SAIU,kCAFP,EAEO;AACd,SAAK,GAAL,GAAW,EAAX;AACD;;AAED,EAAA,OAAO;AACL,EAAA,IADK;;;;AAKL,EAAA,OAAgC,GAAG,EAL9B;AAMC;AACN,QAAI;AACF,MAAA,MADE;AAEF,MAAA,IAFE;AAGA,IAAA,IAHJ;AAIA,QAAI,UAAU,GAAG,gBAAE,IAAF,CAAO,KAAK,MAAZ,EAAoB,UAAS,UAAT,EAAqB;AACxD,aAAO,UAAU,CAAC,MAAX,KAAsB,MAAtB,IAAgC,UAAU,CAAC,IAAX,KAAoB,IAApD,IAA4D,UAAU,CAAC,OAAX,KAAuB,OAAO,CAAC,OAAlG;AACD,KAFgB,CAAjB;AAGA,QAAI,WAAW,GAAG,CAAC,gBAAE,WAAF,CAAc,UAAd,CAAnB;AACA,QAAI,WAAJ,EAAiB;AACf;AACD;AACD,QAAI,QAAQ,GAAI,CAAD,IAAa;AAC1B,UAAI,OAAO,GAAG;AACZ,MAAA,CADY,CAAd;;AAGA,WAAK,GAAL,CAAS,OAAT;AACD,KALD;AAMA,SAAK,MAAL,CAAY,IAAZ,CAAiB;AACf,MAAA,MADe;AAEf,MAAA,IAFe;AAGf,MAAA,OAAO,EAAE,OAAO,CAAC,OAHF,EAAjB;;AAKA,IAAA,MAAM,CAAC,gBAAP,CAAwB,IAAxB,EAA8B,QAA9B,EAAwC,OAAxC;AACD;;AAED,EAAA,SAAS;AACP,EAAA,IADO;;;;AAKP,EAAA,OAA6B,GAAG,EALzB;AAMD;AACN,QAAI;AACF,MAAA,MADE;AAEF,MAAA,IAFE;AAGA,IAAA,IAHJ;AAIA,QAAI,UAAU,GAAG,gBAAE,IAAF,CAAO,KAAK,MAAZ,EAAoB,UAAS,UAAT,EAAqB;AACxD,aAAO,UAAU,CAAC,MAAX,KAAsB,MAAtB,IAAgC,UAAU,CAAC,IAAX,KAAoB,IAApD,IAA4D,UAAU,CAAC,OAAX,KAAuB,OAAO,CAAC,OAAlG;AACD,KAFgB,CAAjB;AAGA,QAAI,WAAW,GAAG,CAAC,gBAAE,WAAF,CAAc,UAAd,CAAnB;AACA,QAAI,CAAC,WAAL,EAAkB;AAChB;AACD;AACD,IAAA,MAAM,CAAC,mBAAP,CAA2B,IAA3B,EAAiC,UAAU,CAAC,QAA5C,EAAsD,OAAtD;AACA;AACA,oBAAE,IAAF,CAAO,KAAK,MAAZ,EAAoB,UAApB;AACD;;AAED,EAAA,UAAU,GAAS;AACjB,oBAAE,OAAF,CAAU,KAAK,MAAf,EAAuB,CAAC;AACtB,MAAA,MADsB;AAEtB,MAAA,IAFsB;AAGtB,MAAA,OAHsB,EAAD;AAIjB;AACJ,WAAK,SAAL,CAAe;AACb,QAAA,IADa;AAEb,QAAA,MAFa,EAAf;AAGG;AACD,QAAA,OADC,EAHH;;AAMD,KAXD;AAYD,GA7E8B,C","file":"event-target-observer.js","sourcesContent":["import _ from 'lodash';\n\nexport class EventTargetObserver {\n  _cb = undefined;\n\n  _cache = [];\n\n  constructor(cb) {\n    this._cb = cb;\n  }\n\n  observe(\n    args: {\n      target: Node;\n      type: string;\n    },\n    options: AddEventListenerOptions = {}\n  ): void {\n    let {\n      target,\n      type\n    } = args;\n    let cacheEntry = _.find(this._cache, function(cacheEntry) {\n      return cacheEntry.target === target && cacheEntry.type === type && cacheEntry.capture === options.capture;\n    });\n    let isObserving = !_.isUndefined(cacheEntry);\n    if (isObserving) {\n      return;\n    }\n    let listener = (e): void => {\n      let entries = [\n        e\n      ];\n      this._cb(entries);\n    };\n    this._cache.push({\n      target,\n      type,\n      capture: options.capture\n    });\n    target.addEventListener(type, listener, options);\n  }\n\n  unobserve(\n    args: {\n      target: Node;\n      type: string;\n    },\n    options: EventListenerOptions = {}\n  ): void {\n    let {\n      target,\n      type\n    } = args;\n    let cacheEntry = _.find(this._cache, function(cacheEntry) {\n      return cacheEntry.target === target && cacheEntry.type === type && cacheEntry.capture === options.capture;\n    });\n    let isObserving = !_.isUndefined(cacheEntry);\n    if (!isObserving) {\n      return;\n    }\n    target.removeEventListener(type, cacheEntry.listener, options);\n    // eslint-disable-next-line lodash/prefer-immutable-method\n    _.pull(this._cache, cacheEntry);\n  }\n\n  disconnect(): void {\n    _.forEach(this._cache, ({\n      target,\n      type,\n      capture\n    }) => {\n      this.unobserve({\n        type,\n        target\n      }, {\n        capture\n      });\n    });\n  }\n}\n"]}